<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!--	CSRF -->
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>


    <link rel="stylesheet" href="../frontend/css/font-awesome.min.css" th:href="@{/frontend/css/font-awesome.min.css}">
    <link rel="stylesheet" href="../frontend/css/main.css" th:href="@{/frontend/css/main.css}">
    <link rel="stylesheet" href="../frontend/ztree/zTreeStyle.css" th:href="@{/frontend/ztree/zTreeStyle.css}">
    <link rel="stylesheet" href="../frontend/bootstrap/css/bootstrap.min.css" th:href="@{/frontend/bootstrap/css/bootstrap.min.css}">



    <script src="../frontend/jquery/jquery-2.1.1.min.js" th:src="@{/frontend/jquery/jquery-2.1.1.min.js}"></script>
    <script src="../frontend/bootstrap/js/bootstrap.min.js" th:src="@{/frontend/bootstrap/js/bootstrap.min.js}"></script>
    <script src="../frontend/script/docs.min.js" th:src="@{/frontend/script/docs.min.js}"></script>

    <!-- ztree   -->
    <script src="../frontend/ztree/jquery.ztree.all-3.5.min.js" th:src="@{/frontend/ztree/jquery.ztree.all-3.5.min.js}"></script>

    <script src="../frontend/layer/layer/layer.js" th:src="@{/frontend/layer/layer/layer.js}"></script>
    <script type="text/javascript" th:inline="javascript">
        $(function () {
            $(".list-group-item").click(function(){
                if ( $(this).find("ul") ) {
                    $(this).toggleClass("tree-closed");
                    if ( $(this).hasClass("tree-closed") ) {
                        $("ul", this).hide("fast");
                    } else {
                        $("ul", this).show("fast");
                    }
                }
            });
        });
        $(function () {
            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");
            // 1.準備產生樹形結構的 JSON 數據，數據的來源是發送 Ajax 請求得到
            $.ajax({
                "url": "/menu/get/whole/tree.json",
                "type": "post",
                "dataType": "json",
                "beforeSend": function (xhr) {
                    xhr.setRequestHeader(header, token);
                },
                "success": function (response) {
                    var result = response.result;
                    if (result == "SUCCESS") {
                        // 2.建立 JSON 對像用於儲存對 zTree 所做的設定
                        var setting = {};
                        // 3.從響應體中獲取用來產生樹形結構的 JSON 數據
                        var zNodes = response.data;
                        // 4.初始化樹形結構
                        $.fn.zTree.init($("#treeDemo"), setting, zNodes);
                    }

                    if (result == "FAILED") {
                        layer.msg(response.message);
                    }
                }
            });
        })
    </script>
    <style>
        .tree li {
            list-style-type: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div th:insert="~{common-navbar::navbar}"></div>

<div class="container-fluid">
    <div class="row">
        <div th:insert="~{common-sidebar::sidebar}"></div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

            <div class="panel panel-default">
                <div class="panel-heading">
                    <i class="glyphicon glyphicon-th-list"></i> 許可權菜單列表
                    <div style="float: right; cursor: pointer;" data-toggle="modal"
                         data-target="#myModal">
                        <i class="glyphicon glyphicon-question-sign"></i>
                    </div>
                </div>
                <div class="panel-body">
                    <!-- 這個ul標籤是zTree動態產生的節點所依附的靜態節點 -->
                    <ul id="treeDemo" class="ztree"></ul>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>